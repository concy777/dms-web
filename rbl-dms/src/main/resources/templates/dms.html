 <!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">
<head>
		
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
<title>RBL | DMS</title>
		
		<link href="/css/bootstrap.min.css" rel="stylesheet">
		<link href="/css/plugins/iCheck/custom.css" rel="stylesheet">
		<link href="/css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
		<link href="/css/plugins/datapicker/datepicker3.css" rel="stylesheet">
		<link href="/css/plugins/jasny/jasny-bootstrap.min.css" rel="stylesheet">
		<link href="/css/plugins/cropper/cropper.min.css" rel="stylesheet">
		<link href="/css/plugins/daterangepicker/daterangepicker-bs3.css" rel="stylesheet">
		<link href="/css/plugins/dataTables/datatables.min.css" rel="stylesheet">
		<link href="/font-awesome/css/font-awesome.css" rel="stylesheet">
		 <link href="/css/plugins/toastr/toastr.min.css" rel="stylesheet">
		
		 <link href="/css/plugins/ladda/ladda-themeless.min.css" rel="stylesheet">
		<link href="/css/animate.css" rel="stylesheet">
		<link href="/css/style.css" rel="stylesheet">
		<link href="/css/plugins/iCheck/custom.css" rel="stylesheet">
		
		
		<style>
		


#overlay{	
  position: fixed;
  top: 0;
  z-index: 100;
  width: 100%;
  height:100%;
  display: none;
  background: rgba(0,0,0,0.6);
}
.cv-spinner {
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;  
}
.spinner {
  width: 40px;
  height: 40px;
  border: 4px #ddd solid;
  border-top: 4px #2e93e6 solid;
  border-radius: 50%;
  animation: sp-anime 0.8s infinite linear;
}
@keyframes sp-anime {
  100% { 
    transform: rotate(360deg); 
  }
}
.is-hide{
  display:none;
}

.image_preview:hover {
  transform: scale(2.0); /* (150% zoom - Note: if the zoom is too large, it will go outside of the viewport) */
}
		.no-js #loader { display: none;  }
.js #loader { display: block; position: absolute; left: 100px; top: 0; }
.se-pre-con {
	position: fixed;
	left: 0px;
	top: 0px;
	width: 100%;
	height: 100%;
	z-index: 9999;
	background: url(images/loader-64x/Preloader_8.gif) center no-repeat #fff;
}

.error {
  font-size: 12px;
  padding: 6px 0 4px;
  color: red;
  display: block
}

.pdfobject-container {
    max-width: 100%;
	width: 600px;
	height: 600px;
	border: 10px solid rgba(0,0,0,.2);
	margin: 0;
}
		</style>
		
		
</head>

<body class="gray-bg top-navigation">
<input type="hidden" id="updateModal" th:value="${updateModal}"/>
    <div id="wrapper" >
        <div  class="gray-bg">
            <div class="row border-bottom white-bg">
        <nav  class="navbar navbar-static-top" role="navigation">
            <div   class="navbar-header">
                <button aria-controls="navbar" aria-expanded="false" data-target="#navbar" data-toggle="collapse" class="navbar-toggle collapsed" type="button">
                    <i class="fa fa-reorder"></i>
                </button>
                 <a style="background-color: #304087" href="#" onclick="location.reload()" class="navbar-brand">DMS</a>
            </div>
            <div class="navbar-collapse collapse" id="navbar">
            
                <ul class="nav navbar-top-links navbar-right">
                
                <li>
                
                    <span class="m-r-sm text-muted welcome-message">Welcome</span><span th:text="${session.user}"></span>
              
                </li>
                
                
                   <li>
                        <a href="/logout" >
                            <i class="fa fa-sign-out"></i> Log out
                        </a>
                    </li>
                </ul>
            </div>
            <div class="navbar-collapse collapse" id="navbar" th:if="${#strings.contains(session.userrole, 'ROLE_SUPER_ADMIN')}">
					<ul class="nav navbar-top-links navbar-right">				
                <li class="dropdown">
                        <a aria-expanded="false" role="button" href="#" class="dropdown-toggle" data-toggle="dropdown"> More <span class="caret"></span></a>
                        <ul role="menu" class="dropdown-menu">
                            <li><a href="/dms-app/app-utility">Run Utility</a></li>
                            
                        </ul>
                    </li>
                    </ul>
                    </div>
        </nav>
        </div> 
        <div class="wrapper wrapper-content animated fadeIn">
        
        				<div class="row">
					<div class="col-lg-12">
						<div class="ibox" id="ibox1">
							<div class="ibox-title">
								<div
									th:if="${#strings.contains(session.userrole, 'ROLE_SUPER_ADMIN')}">
									<div class="ibox-tools">
										<a data-toggle="modal" href="#myModal5"
											class="btn btn-primary btn-xm">Upload Files</a>
									</div>
								</div>
							</div>
							<div class="ibox-content">
							
								<form id="searchForm" name="searchAcc" role="form">
									
									<!-- <form id="searchForm" name="searchAcc" role="form"
									onSubmit="return anyvalidate()" action="#"
									th:action="@{user/api/search}" method="POST"> -->
									<div class="row">

										<div class="col-sm-3">
											<div class="form-group col-md-8">
												<label>CIF ID</label> <input type="text" id="CifId"
													name="CifId" value=""
													th:field="${searchReq.body.documentTags.cifId}"
													placeholder="Enter CIF ID" class="form-control">
											</div>
										</div>


										<div class="col-sm-3">
											<div class="form-group col-md-8">
												<label>UCIC</label> <input type="text" id="UCIC" name="UCIC"
													value="" th:field="${searchReq.body.documentTags.ucic}"
													placeholder="Enter UCIC" class="form-control">
											</div>
										</div>

										<div class="col-sm-3">
											<div class="form-group col-md-10">
												<label>Account No</label> <input type="text"
													id="accountNumber" name="accountNumber" value=""
													th:field="${searchReq.body.documentTags.accountNumber}"
													placeholder="Enter Account No" class="form-control">
											</div>
										</div>

										<div class="col-sm-3">
											<div class="form-group col-md-8">
												<label>Ref No</label> <input type="text"
													id="referenceNumber" name="referenceNumber" value=""
													th:field="${searchReq.body.documentTags.referenceNumber}"
													placeholder="Enter Reference No" class="form-control">
											</div>
										</div>

									</div>
									<div class="row">
										<div class="col-sm-3">
											<div class="form-group col-md-10">
												<label>Doc Folder</label> <select
													th:field="${searchReq.body.documentTags.docFolder}"
													id="docFolder" name="docFolder" class="form-control m-b">
													<option value="">Select</option>
													<option value="CAMS">CAMS</option>
													<option value="ABASCUS">ABASCUS</option>
													<option value="SF">SF</option>
													<option value="TAB">TAB</option>
												</select>
											</div>
										</div>
										<div class="col-sm-3">
											<div class="form-group  col-md-8">
												<label>Source System</label> <select
													class="form-control m-b" id="sourceSystem"
													th:field="${searchReq.body.documentTags.sourceSystem}"
													name="sourceSystem">
													<option value="">Select</option>
													<option value="FINACLE">FINACLE</option>
													<option value="MIFIN">MIFIN</option>
													<option value="DMR">DMR</option>
													<option value="ECBF">ECBF</option>
													<option value="GANASEVA">GANASEVA</option>
													<option value="INDUS">INDUS</option>
													<option value="CREDIT CARDS">CREDIT CARDS</option>
													<option value="MF">MF</option>
													<option value="INSURANCE">INSURANCE</option>
												</select>
											</div>

										</div>
										<div class="col-sm-3">
											<div class="form-group col-md-12" id="data_5">
												<label class="font-normal">Date Range</label>
												<div class="input-daterange input-group" id="datepicker">
													<input type="text" class="input-sm form-control"
														name="from" placeholder="From Date"
														th:field="${searchReq.body.documentTags.dateOfAccOpening.from}"
														value="" /> <span class="input-group-addon">to</span> <input
														type="text" class="input-sm form-control" name="to"
														placeholder="To Date"
														th:field="${searchReq.body.documentTags.dateOfAccOpening.to}"
														value="" />
												</div>
											</div>
										</div>


									</div>

									<div style="text-align: center" class="row">
										<div class="col-sm-12">
											<div class="form-group">
												<button type="submit" class="btn btn-primary">Search</button>
												&nbsp;&nbsp;&nbsp;
												<button type="button" id="resetForm" class="btn btn-primary">Reset</button>
											</div>

										</div>
									</div>

									<div id="searchError" style="text-align: center; display: none"
										class="row">
										<div class="alert alert-danger" role="alert">
											<span id="searchFormError" class="error"></span>
										</div>
									</div>

									<div style="text-align: center" class="row">
										<div class="alert alert-danger" role="alert"
											th:if="${#strings.equals(searchRes.status.statusCode, '1')}"
											th:text="${searchRes.status.displayText}"></div>
									</div>
								</form>
								<div id="imgSpinner1" style="display:none" class="sk-spinner sk-spinner-wave">
                                <div class="sk-rect1"></div>
                                <div class="sk-rect2"></div>
                                <div class="sk-rect3"></div>
                                <div class="sk-rect4"></div>
                                <div class="sk-rect5"></div>
                            </div>
 						
							</div>
							
						</div>
					</div>
				</div>

				<div  th:if="${#strings.equals(searchRes.status.statusCode, '0')}">
					<div id="showTable" class="row">
						<div class="col-lg-12">
							<div class="ibox">
								<div class="ibox-content">
									<div class="table-responsive"
										th:if="!${#lists.isEmpty(searchRes.body.documentDetails)}">
										<table style="width: 100%;" id="uploadTable1"
											class="table table-striped table-bordered table-hover dataTables-example">
											<thead>
												<tr>

													<th>CIF ID</th>
													<th>UCIC</th>
													<th>Source System</th>


												</tr>
											</thead>
											<tbody
												th:if="${not #lists.isEmpty(searchRes.body.documentDetails)}">
												<tr th:each="resp,itemStat  : ${respList}">
													<td th:text="${resp.cifId}"> </td>
													<td th:text="${resp.ucic}"></td>
													<td th:text="${resp.sourceSystem}"></td>
												</tr>

											</tbody>
										</table>
									</div>
								</div>

							</div>
						</div>
					</div>
					
					
					
					<div class="row">
					
					
							<div id="nestedDiv" class="col-lg-12">
								<div class="tabs-container">
									<ul class="nav nav-tabs" role="tablist">
										<li class="active"><a data-toggle="tab" href="#tab-1">KYC
										</a></li>
										<li class=""><a data-toggle="tab" href="#tab-2">Non
												KYC </a></li>
									</ul>
									<div class="tab-content">
										<div role="tabpanel" id="tab-1" class="tab-pane active">
											<div class="ibox">
											<div class="ibox-content">
												<div class="table-responsive">
													<table
														class="table table-striped table-bordered table-hover dataTables-example">

														<thead></thead>
														<tbody>
															<tr>
																<td style="width: 100%">
																	<table
																		class="table table-striped table-bordered table-hover dataTables-example">
																		<tr>
																			<th>Document Name</th>
																			<th>Document Type</th>
																			<th>Document Date</th>
																			<th>Account No</th>
																			<th>CIF No</th>
																			<th>Reference No</th>
																			<th>Doc Folder</th>
																			<th
																				th:if="${!#strings.contains(session.userrole, 'ROLE_USER')}"></th>
																			<th
																				th:if="${!#strings.contains(session.userrole, 'ROLE_USER')}"></th>
																		</tr>
																		<tr th:each="file,itemStat  : ${ckycList}">

																			<td><a
																				th:onclick="loadImage([[${file.documentId}]],[[${file.name}]])"
																				th:text="${file.Name}"></a></td>

																			<td th:text="${file.documentType}" />
																			<td th:text="${file.dateOfAccOpening}" />
																			<td th:text="${file.accountNumber}" />
																			<td th:text="${file.cifId}" />
																			<td th:text="${file.referenceNumber}" />
																			<td th:text="${file.docFolder}" />

																			<td
																				th:if="${!#strings.contains(session.userrole, 'ROLE_USER')}"><a
																				th:onclick="downloadReportFile([[${file.documentId}]],[[${file.name}]])"
																				class="btn btn-primary document"><i
																					class="fa fa-download "></i></a></td>

																			<td
																				th:if="${#strings.contains(session.userrole, 'ROLE_SUPER_ADMIN')}"><a
																				th:onclick="getDoc([[${file.documentId}]])"
																				class="btn btn-primary"><i class="fa fa-edit"></i></a>
																			</td>

																			<!-- th:href="'/up-doc/'+${file.documentId}"  -->

																			<!-- th:onclick="getDoc([[${file.documentId}]])"  -->
																	</table>
																</td>

															</tr>


														</tbody>
													</table>
												</div>
											</div>
											</div>
										</div>
										<div id="tab-2" class="tab-pane">
										<div class="ibox">
											<div class="ibox-content">
												<div class="table-responsive">
													<table
														class="table table-striped table-bordered table-hover dataTables-example">
														<thead></thead>
														<tbody>
															<tr>
																<td style="width: 100%">
																	<table
																		class="table table-striped table-bordered table-hover dataTables-example">
																		<tr>
																			<th>Document Name</th>
																			<th>Document Type</th>
																			<th>Date Of Acc Opening</th>
																			<th>Account No</th>
																			<th>CIF No</th>
																			<th>Reference No</th>
																			<th>Doc Folder</th>
																			<th
																				th:if="${!#strings.contains(session.userrole, 'ROLE_USER')}"></th>
																			<th
																				th:if="${!#strings.contains(session.userrole, 'ROLE_USER')}"></th>
																		</tr>
																		<tr th:each="file,itemStat  : ${nonckycList}">


																			<td><a
																				th:onclick="loadImage([[${file.documentId}]],[[${file.name}]])"
																				th:text="${file.Name}"></a></td>

																			<td th:text="${file.documentType}" />
																			<td th:text="${file.dateOfAccOpening}" />
																			<td th:text="${file.accountNumber}" />
																			<td th:text="${file.cifId}" />
																			<td th:text="${file.referenceNumber}" />
																			<td th:text="${file.docFolder}" />

																			<td
																				th:if="${!#strings.contains(session.userrole, 'ROLE_USER')}"><a
																				th:onclick="downloadReportFile([[${file.documentId}]],[[${file.name}]])"
																				class="btn btn-primary document"><i
																					class="fa fa-download "></i></a></td>

																			<td
																				th:if="${#strings.contains(session.userrole, 'ROLE_SUPER_ADMIN')}"><a
																				th:onclick="getDoc([[${file.documentId}]])"
																				class="btn btn-primary"><i class="fa fa-edit"></i></a>
																			</td>


																		</tr>

																	</table>
																</td>

															</tr>


														</tbody>
													</table>
												</div>
											</div>
											</div>
										</div>
									</div>
								</div>

 <!-- <div th:if="${!#strings.contains(session.user.user_role, 'ROLE_USER')}">
					<div style="align:right" class="ibox-content">

									<h5>
										<a href="#" id="download_all">Download ALL</a>
									</h5>
									<div class="ibox-tools"></div>
								</div>
								</div>  -->
							</div>
						
					</div>
				</div>
                        
        
        
   
</div>
                    </div>
                    </div>
                   
                

  
    
   <div>
		<div class="modal inmodal" id="myModal4" tabindex="-1" role="dialog"
			aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content animated fadeIn">
					<div class="modal-header">
						<h4 class="modal-title">Image Preview</h4>
					</div>
					<div id="imagePreview" class="modal-body"></div>
					<div class="modal-footer">
						<button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
						<!-- <a th:if="${!#strings.contains(session.user.user_role, 'ROLE_USER')}"  class="btn btn-primary" id="downloadImage" ><i class="fa fa-download "></i>Download</a> </div>
                                     -->
					</div>
				</div>
			</div>
		</div>
		
		<div class="modal inmodal" id="myModalError" tabindex="-1" role="dialog"
			aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content animated fadeIn">
					<div class="modal-header">
						<h4 class="modal-title">Error Occured</h4>
					</div>
					<div id="getModalError" class="modal-body"></div>
					<div class="modal-footer">
						<button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
						</div>
				</div>
			</div>
		</div>
		
		

		<div class="modal inmodal" id="myModal8" tabindex="-1" role="dialog"
			aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content animated fadeIn">
					<div class="modal-header">
						<h4 class="modal-title">TIFF Preview</h4>
					</div>
					<div id="pdfView" class="modal-body"></div>
					<div class="modal-footer">
						<button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
						<!--  <a  class="btn btn-primary"  id="downloadImage"><i class="fa fa-download "></i>Download</a> </div>
                                     -->
					</div>
				</div>
			</div>
		</div>

		<div class="modal inmodal" id="myModal9" tabindex="-1" role="dialog"
			aria-hidden="true">
			<div class="modal-dialog modal-lg">
				<div class="modal-content animated fadeIn">
					<div class="modal-header">
						<h4 class="modal-title">PDF Preview</h4>
					</div>
					<div class="modal-body">
						<canvas id="pdf-canvas"></canvas>

					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
						<!-- <a  class="btn btn-primary"  id="downloadImage"><i class="fa fa-download "></i>Download</a> </div>
                                     -->
					</div>
				</div>
			</div>
		</div>
		<div class="modal inmodal" id="myModal6" tabindex="-1" role="dialog"
			aria-hidden="true">
			<form id="updateForm" action="#" role="form"
				th:object="${updateDocTags}" th:fragment="fileModalFragment">
				<div class="modal-dialog">
					<div class="modal-content animated fadeIn">
						<div style="text-align: center" class="row"></div>

						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal">
								<span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
							</button>
							<i class="fa fa-upload icon"></i>
							<h5 class="modal-title">File Update</h5>

						</div>
						<div class="modal-body">
							<div class="row">
								<div class="col-sm-12">
									<input type="hidden" th:field="${updateDocTags.docId}"
										id="blogId">


									<div class="form-group">
										<label>Account No</label> <input type="text"
											id="accountNumber" required="required" placeholder="Required"
											name="accountNumber"
											th:field="${updateDocTags.accountNumber}"
											class="form-control"> <span id="account_error"
											class="error"></span>
									</div>

									<div class="form-group">
										<label>CIF ID</label> <input type="text"
											placeholder="Required" name="cifId" required="required"
											th:field="${updateDocTags.cifId}" class="form-control">
									</div>
									<div class="form-group">
										<label>UCIC</label> <input type="text" required="required"
											placeholder="Required" th:field="${updateDocTags.ucic}"
											name="ucic" class="form-control">
									</div>
									<div class="form-group">
										<label>Reference No</label> <input type="text"
											placeholder="Required" required="required"
											th:value="${updateDocTags.referenceNumber}"
											name="referenceNumber" class="form-control">
									</div>
									<div class="form-group">
										<label>Doc Type</label> <select
											th:field="${updateDocTags.documentType}"
											class="form-control m-b" required="required"
											name="documentType">
											<option value="">Select</option>
											<option value="POI">POI</option>
											<option value="POA">POA</option>
											<option value="Other">Other</option>
										</select>
									</div>
									<div class="form-group">
										<label>Doc Folder</label> <select
											th:field="${updateDocTags.docFolder}"
											class="form-control m-b" id="docFolder" required="required"
											name="docFolder">
											<option value="">Select</option>
											<option value="CAMS">CAMS</option>
											<option value="SF">SF</option>
											<option value="TAB">TAB</option>
											<option value="ABACUS">ABACUS</option>
										</select>
									</div>
									<div class="form-group">
										<label class="font-noraml">Date Opening</label>
										<div class="input-group date">
											<span class="input-group-addon"><i
												class="fa fa-calendar"></i></span><input type="text"
												id="dateOfAccOpening_new" name="dateOfAccOpening"
												th:field="${updateDocTags.dateOfAccOpening}"
												class="form-control">
										</div>
									</div>
									<div class="form-group">
										<label>Source System</label> <select
											th:field="${updateDocTags.sourceSystem}"
											class="form-control m-b" required="required"
											name="sourceSystem">
											<option value="">Select</option>
											<option value="FINACLE">FINACLE</option>
											<option value="MIFIN">MIFIN</option>
											<option value="DMR">DMR</option>
											<option value="ECBF">ECBF</option>
											<option value="GANASEVA">GANASEVA</option>
											<option value="INDUS">INDUS</option>
											<option value="CREDIT CARDS">CREDIT CARDS</option>
											<option value="MF">MF</option>
											<option value="INSURANCE">INSURANCE</option>

										</select>
									</div>

									<div class="form-group">
										<label>Doc Name</label> <input type="text"
											placeholder="Required" required="required"
											th:field="${updateDocTags.name}" name="name"
											class="form-control">
									</div>

									
								</div>


							</div>
						</div>

						<div class="modal-footer">

							<button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
							<button type="button" onclick="uploadDoc()" data-style="zoom-in"
								class="btn btn-primary">
								<i class="fa fa-upload "></i> Save
							</button>
						</div>



						<div></div>
						<div class="alert alert-success" role="alert"
							th:text="${addRes.displayText}"
							th:if="${#strings.equals(addRes.statusCode, '0')}"></div>

						<div class="alert alert-danger" role="alert"
							th:text="${addRes.displayText}"
							th:if="${#strings.equals(addRes.statusCode, '1')}"></div>


					</div>
				</div>
			</form>
		</div>
		
		
		<div class="modal inmodal" id="myModal5" tabindex="-1" role="dialog"
		aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content animated fadeIn">
				<div style="text-align: center" class="row"></div>
				<form id="uploadForm" action="#" role="form" th:object="${addReq}"> 
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">
							<span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
						</button>
						<i class="fa fa-upload icon"></i>
						<h5 class="modal-title">File Upload</h5>
						<small class="font-bold">Note. File Size should be less
							than 10MB.</small>
					</div>
					<div class="modal-body">
						<div class="row">
							<div class="col-sm-6">


								<div class="form-group">
									<label>Account No</label> <input type="text" id="accNo" maxlength="20"
										required="required" placeholder="Required" name="accNo"
										th:value="${accNo}" class="uploadFld form-control"> <span
										class="error" id="account_error"></span>

								</div>

								<div class="form-group">
									<label>CIF ID</label> <input type="text" placeholder="Required" maxlength="20"
										name="cifId" required="required" th:value="${cifId}"
										class="uploadFld form-control">
								</div>
								<div class="form-group">
									<label>UCIC</label> <input type="text" required="required" maxlength="10"
										placeholder="Required" th:value="${ucic}" name="ucic"
										class="uploadFld form-control">
								</div>
								<div class="form-group">
									<label>Reference No</label> <input type="text"
										required="required" placeholder="Required"
										th:value="${referenceNumber}" name="referenceNumber"
										class="uploadFld form-control">
								</div>
								<div class="form-group">
									<label>Identification Number</label> <input type="text"
										required="required" placeholder="Required"
										th:value="${identificationNumber}" name="identificationNumber"
										class="uploadFld form-control">
								</div>

								<div class="form-group">
									<label>Doc Type</label> <select class="form-control m-b"
										name="documentType">
										<option>Select</option>
										<option>POI</option>
										<option>POA</option>
										<option>Other</option>
									</select>
								</div>
							</div>
							<div class="col-sm-6">
								<div style="margin-bottom: 25px" class="form-group">
									<label>Doc Folder</label> <select class="form-control m-b"
										id="docFolder" required="required" name="docFolder">
										<option value="">Select</option>
										<option>CAMS</option>
										<option>SF</option>
										<option>TAB</option>
										<option>ABACUS</option>
									</select>

								</div>

								<div class="form-group">
									<label class="font-normal">Date Opening</label>
									<div class="input-group date">
										<span class="input-group-addon"><i
											class="fa fa-calendar"></i></span><input type="text"
											id="dateOfAccOpening" name="dateOfAccOpening"
											th:value="${dateOfAccOpening}" class="form-control">
									</div>
								</div>
								<div class="form-group">
									<label>Source System</label> <select class="form-control m-b"
										required="required" name="sourceSystem">
										<option value="">Select</option>
										<option>FINACLE</option>
										<option>MIFIN</option>
										<option>DMR</option>
										<option>ECBF</option>
										<option>GANASEVA</option>
										<option>INDUS</option>
										<option>CREDIT CARDS</option>
										<option>MF</option>
										<option>INSURANCE</option>
									</select>
								</div>

								<div class="form-group">
									<label>KYC ID</label> <input type="text" placeholder="Required"
										required="required" th:value="${kycId}" name="kycId"
										class="uploadFld form-control">
								</div>

								<div style="margin-bottom: 38px" class="form-group">
									<label>Doc Name</label> <input type="text"
										placeholder="Required" required="required" th:value="${name}"
										name="name" class="uploadFld form-control">
								</div>

								<div class="form-group fileinput fileinput-new input-group"
									data-provides="fileinput">
									<div class="form-control" data-trigger="fileinput">
										<i class="glyphicon glyphicon-file fileinput-exists"></i> <span
											class="fileinput-filename"></span>
									</div>
									<span class="input-group-addon btn btn-default btn-file"><span
										class="fileinput-new">Select file</span><span
										class="fileinput-exists">Change</span><input type="file"
										id="fileUpd" name="file" placeholder="Required"
										required="required"></span> <a href="#"
										class="input-group-addon btn btn-default fileinput-exists"
										data-dismiss="fileinput">Remove</a>
								</div>
							</div>

						</div>


					</div>

					<div class="modal-footer">

						<button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
						<button type="submit" data-style="zoom-in"
							class="btn btn-primary">
							<i class="fa fa-upload "></i> Upload
						</button>
					</div>

<div id="overlay">
  <div class="cv-spinner">
    <span class="spinner"></span>
  </div>
</div>

					<div></div>
					<div class="alert alert-success" role="alert"
						th:text="${addRes.displayText}"
						th:if="${#strings.equals(addRes.statusCode, '0')}"></div>

					<div class="alert alert-danger" role="alert"
						th:text="${addRes.displayText}"
						th:if="${#strings.equals(addRes.statusCode, '1')}"></div>
						
						

				</form>
			</div>
		</div>
	</div>
		

	</div>

	


	<!-- Mainly scripts -->
  <script src="/js/jquery-3.3.1.min.js"></script>
    <script src="/js/bootstrap-4.3.1-dist/js/bootstrap.bundle.min.js"></script>
   <script src="/js/plugins/jquery-ui/jquery-ui.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
	<script src="/js/plugins/peity/jquery.peity.min.js"></script>
     <script src="/js/plugins/dataTables/datatables.min.js"></script>
    <!-- Custom and plugin javascript -->
    <script src="/js/inspinia.js"></script>
    <script src="/js/plugins/pace/pace.min.js"></script>
    <script src="/js/plugins/typehead/bootstrap3-typeahead.min.js"></script>
       <script src="/js/plugins/fullcalendar/moment.min.js"></script>
     <script src="/js/plugins/datapicker/bootstrap-datepicker.js"></script>
     <script src="/js/plugins/cropper/cropper.min.js"></script>
     <script src="/js/plugins/daterangepicker/daterangepicker.js"></script>
    
	<script src="/js/plugins/validate/jquery.validate.min.js"></script>

      <script src="/js/plugins/iCheck/icheck.min.js"></script>
    <script src="/js/plugins/sweetalert/sweetalert.min.js"></script>
     <script src="/js/plugins/chosen/chosen.jquery.js"></script>
	<script src="/js/plugins/jasny/jasny-bootstrap.min.js"></script>
	
	 <script src="/js/plugins/ladda/spin.min.js"></script>
    <script src="/js/plugins/ladda/ladda.min.js"></script>
    <script src="/js/plugins/ladda/ladda.jquery.min.js"></script>
<script src="/js/pdf.js"></script>
<script src="/js/pdf.worker.js"></script>
<script src="/js/download.js"></script>
<script src="/js/tiff.min.js"></script>
<script src="/js/jquery-multidownload.js"></script>



    <script>
    
    
    $("#searchForm").submit(function(e) {
    	
    	if(anyvalidate()){
    		
    		e.preventDefault(); // prevent actual form submit
            var token =  '[[${session.token}]]';
            var form = $(this);
            var url = "/dms-app/user/search-doc";
            
            $.ajax({
                 type: "POST",
                 url: url,
                 headers: {"Authorization": 'Bearer '+token},
                 data: form.serialize(),
                 beforeSend: function() {
                	    $("#imgSpinner1").show();
                	  },
                	  complete: function() {
                	    $("#imgSpinner1").hide();
                	  },
                 success: function(data){
                	 $("body").html(data);

                 },
                 error: function(xhr) { 
	                    swal({
							title : "Error Occured!",
							text : "Something went wrong. Please contact support team.",
							type : "error"
						});
	                }
            });
    	}
    	
    	else{
    		return false;
    	}
        
    });
   
    $("#searchForm2").submit(function(event) {
        event.preventDefault(); //prevent default action 
        var token =  '[[${session.token}]]';
        var url = "/dms-app/user/search-doc";

        var xhr = new XMLHttpRequest();
        xhr.open("POST", url);

       // xhr.setRequestHeader("Accept", "application/json");
        xhr.setRequestHeader("Authorization", "Bearer "+token);
       xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
       // xhr.setRequestHeader("Content-Length", "0");
       var form = $('#searchForm')[0];
 	var data = new FormData(form);
 	console.log(data);
        xhr.onreadystatechange = function () {
           if (xhr.readyState === 4) {
             // console.log(xhr.status);
              console.log(xhr.responseText);
           }};

        xhr.send();
       /*  let post_url = $(this).attr("action"); //get form action url
        let form_data = $(this).serialize(); //Encode form elements for submission      	
        $.post(post_url, form_data, function(response) {
        	//alert(response);
        	$('#searchForm').attr('action', '/dms-app/user/search-doc');
        	$('#searchForm').submit();
        	event.preventDefault();
        	return true;
        }); */
      });
    
   

        $('#toggleSpinners').on('click', function(){

            $('#ibox1').children('.ibox-content').toggleClass('sk-loading');
            $('#ibox2').children('.ibox-content').toggleClass('sk-loading');

        });

   
    
    
    $(document).ajaxSend(function() {
        $("#overlay").fadeIn(300);　
      });

    	
    	$('#downloadImage').click(function() {
    		download($('#imageFile').attr('src'),$('#imageFile').attr('name'),"image/jpeg");
    		});
    	
    	 $('#dateOfAccOpening').datepicker({
	        todayBtn: "linked",
	        keyboardNavigation: false,
	        forceParse: false,
	        calendarWeeks: true,
	        autoclose: true,
	    	format: 'yyyy-mm-dd'
	    }); 
    	 
    	 $('#dateOfAccOpening_new').datepicker({
 	        todayBtn: "linked",
 	        keyboardNavigation: false,
 	        forceParse: false,
 	        calendarWeeks: true,
 	        autoclose: true,
 	    	format: 'yyyy-mm-dd'
 	    }); 
     	 
    	 
    	 $('#data_5 .input-daterange').datepicker({
             keyboardNavigation: false,
             forceParse: false,
             autoclose: true,
             format: 'yyyy-mm-dd'
         });
    	
    	$('.i-checks').iCheck({
            checkboxClass: 'icheckbox_square-green',
            radioClass: 'iradio_square-green'
        });
    	
    
    	$('#download_all').click(function (event) {
    	    event.preventDefault();
    	    $('.document').multiDownload();
    	});
    	
    $("#uploadForm").validate({
    	  rules: {
    	    accNo: {
    	      minlength: 4
    	    },
    	    accNo: {
      	      maxlength: 20
      	    },
      	  name: {
      	      maxlength: 50
      	    },
    	    messages : {
    	    	accNo : {
					required : "Please enter valid account Number."
				},
				name : {
					required : "Maximum length exceeded for name."
				}
			}
    	  }
    	});
    
    $("#updateForm").validate({
  	  rules: {
  	    accNo: {
  	      minlength: 16
  	    },
  	    name: {
    	      maxlength: 10
    	    },
  	    messages : {
  	    	accNo : {
					required : "Please enter 16 digit Number."
				},
				name : {
					required : "Please enter less than or equal to 10 digit Number."
				}
			}
  	  }
  	});
   

    $("#resetForm").click(function (ev) {
    	
  	  ev.preventDefault();
        $(this).closest('form').find("input").each(function(i, v) {
            $(this).val("");
        });
        $('#uploadTable1 tbody').empty();
        $('#showTable').hide();
        $('#nestedDiv').hide();
        
  	  return false; // prevent submitting
  	});
    	 
    				
					$('#fileUpd').bind('change', function() {
			            
			            if(this.files[0].size/1024/1024>=10){
			            	swal({
								title : "Error Occured!",
								text : "File Size should be less than 10 MB.",
								type : "error"
							});
			            	
			            	$('#fileUpd').val('');
			            	
			            }
			            else{
			            	return true;
			            }
			        });
					
					$("#uploadForm")
							.submit(
									function(evt) {
										evt.preventDefault();
										
											var empty = $(this).find("input, select").filter(function() {
												  return this.value === "";
												});
											//alert(empty.length);
											
											var token =  '[[${session.token}]]'; 
												//alert(token);
											
										if (empty.length <= 1) {
												
												$.ajax({
													url : '/dms-app/admin/upload-doc',
													type : 'POST',
													data : new FormData(this),
													async : false,
													cache : false,
													contentType : false,
													enctype : 'multipart/form-data',
													processData : false,
													headers: {"Authorization": 'Bearer '+token},
													success : function(response) {
														$("#overlay").fadeOut(300);
														if (response.StatusCode == '0') {
														
															document
																	.getElementById(
																			"uploadForm")
																	.reset();
															swal({
																title : "Success!",
																text : "Record Saved Successfully!",
																type : "success"
															});

														} else {
															$("#overlay").fadeOut(300);
															swal({
																title : "Error Occured!",
																text : response.DisplayText,
																type : "error"
															});
															
														}
													},
										error: function(xhr) { 
											$("#overlay").fadeOut(300);
											//console.log(xhr);
						                    swal({
												title : "Error Occured!",
												text : "Something went wrong. Please contact support team.",
												type : "error"
											});
						                }  
												});
												}  else { 
													
												     return false;
												} 
								        										
										
									});
					
					function validateForm() {

						  var formInvalid = false;
						  $('#updateForm input').each(function() {
						    if ($(this).val() != '') {
						      formInvalid = true;
						    }
						  });

						  if (formInvalid)
						    alert('One or Two fields are empty. Please fill up all fields');
						}
					
					function uploadDoc(){
						
						var formval=new FormData(document.getElementById("updateForm"));
						for (var pair of formval.entries()) {
						    console.log(pair[0]+ ', ' + pair[1]); 
						}
						 
						$.ajax({
									url : 'dms-app/admin/update-doc',
									type : 'POST',
									data : new FormData(document.getElementById("updateForm")),
									cache: false,
							        timeout: 600000,
							        processData: false,
							        contentType: false,
									success : function(response) {
										console.log(response);
										 l.ladda('stop');
										if (response.StatusCode == '0') {
										
											
											swal({
												title : "Success!",
												text : "Record Saved Successfully!",
												type : "success"
											});

											
										} else {
											 
											swal({
												title : "Error Occured!",
												text : response.DisplayText,
												type : "error"
											});
											
										}
									},
						error: function(xhr) { 
							
		                    swal({
								title : "Error Occured!",
								text : "Something went wrong. Please contact support team.",
								type : "error"
							});
		                }  
								});
						
					}
					
					
					$("#updateFormSubmit")
					.click(
							function(evt) {
								evt.preventDefault();
								 l.ladda('start');
								//alert("--update doc---");	
								
								var formval=new FormData(this);
								for (var pair of formval.entries()) {
								    console.log(pair[0]+ ', ' + pair[1]); 
								}
								 
								$.ajax({
											url : 'dms-app/admin/update-doc',
											type : 'POST',
											data : new FormData(this),
											cache: false,
									        timeout: 600000,
									        processData: false,
									        contentType: false,
											success : function(response) {
												console.log(response);
												 l.ladda('stop');
												if (response.StatusCode == '0') {
												
													
													swal({
														title : "Success!",
														text : "Record Saved Successfully!",
														type : "success"
													});

													
												} else {
													 l.ladda('stop');
													swal({
														title : "Error Occured!",
														text : response.DisplayText,
														type : "error"
													});
													
												}
											},
								error: function(xhr) { 
									l.ladda('stop');
				                    swal({
										title : "Error Occured!",
										text : "Something went wrong. Please contact support team.",
										type : "error"
									});
				                }  
										});
								return false;
							});

					
					function getDoc(id){
						
						//alert('--getDoc--'+id);
						
						$.ajax({
							url : 'dms-app/admin/up-doc/'+id,
							type : 'GET',
							success : function(response) {
								//console.log(response);
								//alert(response);
								$('#myModal6').empty().append(response);
								$('#myModal6').modal('show');
  			                    },
								error: function(xhr) { 
									//l.ladda('stop');
				                    swal({
										title : "Error Occured!",
										text : "Something went wrong. Please contact support team.",
										type : "error"
									});
				                }  
							
						});
						
								
					}
						
					
					function showModal(){
						
						var up=	$('#updateModal').val();

						if(up==1){
							$('#myModal6').modal('show');
							return true;
						}
							return true;
							
						}	
					
					
					
					
					function downloadReportFile(id,name){
						
						var token =  '[[${session.token}]]'; 
						//alert(token);
						
			    		
			    		$.ajax({
							url : '/dms-app/admin/download-doc/'+id,
							type : 'GET',
							headers: {"Authorization": 'Bearer '+token},
							statusCode : {
								200 : function(data,status,xhr) {
									var contentType=xhr.getResponseHeader('Content-type');
									console.log(contentType);
									var link = document.createElement("a");
    
    
    if(contentType=='application/pdf'){
    	 link.href = "data:application/pdf;base64,"+data;
    	 link.setAttribute('download', name+'.pdf');
    }
    else if(contentType=='application/image'){
    	link.href = "data:application/image;base64,"+data;
    	link.setAttribute('download', name+'.jpeg');
    }
    else if(contentType=='application/tiff'){
    	link.href = "data:application/tiff;base64,"+data;
    	link.setAttribute('download', name+'.tiff');
    }
    else{
    	link.href = "data:application/octet-stream;base64,"+data;
    	link.setAttribute('download', name);
    }
    
    document.body.appendChild(link);
    link.click();
   link.remove();
  
									
				                    }
								},
								error: function(xhr) { 
									
				                    swal({
										title : "Error Occured!",
										text : "Something went wrong. Please contact support team.",
										type : "error"
									});
				                }
							
						});
			    	
			    	}

					
					
					function submitUpload(theForm) {

						//alert('uploadform' + theForm);
						$("#uploadForm").submit();
					}

					function mySubmit(theForm) {

						$("#form").submit();

					}
					
					
					function accountNumberValidate() {
				        var aadhar = document.getElementById("accNo").value;
				        //var adharcardTwelveDigit = /^\d{12}$/;
				        var adharSixteenDigit = /^\d{16}$/;
				        if (aadhar != '') {
				            if (aadhar.match(adharSixteenDigit)) {
				            	document.getElementById('account_error').innerHTML='';
				            	 $('#account_error').hide();
				                return true;
				            }
				            else {
				            	document.getElementById('account_error').innerHTML = 'Enter valid 16 digit Account Number.';
				            	$('#account_error').show();
				                return false;
				            }
				        }
				    }

					function closeMe() {
						var win = open(location, '_self').close();
						return false;
					}

					
					$('.dataTables-example').DataTable({
						fixedHeader : true,
						// scrollY:        '80vh',
						//scrollCollapse: true,
						//scrollX: true,
						//sScrollXInner: '100%',

						pageLength : 25,
						iDisplayLength : 150,
						// responsive: true,
						dom : '<"html5buttons"B>lTfgitp',
						//dom: "Bfrtip",

						columns : [],
						buttons : []

					});

					jQuery.extend(jQuery.fn.dataTableExt.oSort, {
						"date-uk-pre" : function(a) {
							var ukDatea = a.split('-');
							return (ukDatea[2] + ukDatea[1] + ukDatea[0]) * 1;
						},

						"date-uk-asc" : function(a, b) {
							return ((a < b) ? -1 : ((a > b) ? 1 : 0));
						},

						"date-uk-desc" : function(a, b) {
							return ((a < b) ? 1 : ((a > b) ? -1 : 0));
						}
					});

					
					
					function toggle() {
						var x = document.getElementById("nestedTable");

						if (x.style.display === "none") {
							x.style.display = "block";
						} else {
							x.style.display = "none";
						}

					}

					function downloadImage(name) {

					//	alert('Download Image---');

						$.ajax({
							url : 'dms-app/admin/downloadfile/First_img.png',
							type : 'GET',
							statusCode : {
								200 : function(data) {
									return true;
								}
							}
						});

					}
					
					/* $('#uploadForm').submit(function () {

						 $('.uploadFld').each(function(){
						        if( $(this).val() == "" ){
						        	document.getElementById("uploadError").style.display="block";
									$("#uploadFormError").html("Please fill all the required fields.");
								     return false;
						        }
						    });
					}); */
					
					function check_required_inputs() {
					    $('.uploadFld').each(function(){
					        if( $(this).val() == "" ){
					        	document.getElementById("uploadError").style.display="block";
								$("#uploadFormError").html("Please fill all the required fields.");
							     return false;
					        }
					    });
					}
					
					
					function anyvalidate() {
						
						if (       searchAcc.CifId.value == ""
							&& searchAcc.UCIC.value == ""
							&& searchAcc.accountNumber.value == ""
								&& searchAcc.referenceNumber.value == ""
									&& searchAcc.sourceSystem.value == ""
							) {
							document.getElementById("searchError").style.display="block";
							$("#searchFormError").html("You need to enter at least 1 field to perform a search");
						//alert( "You need to complete at least 1 field to conduct a search" );
						     return false;
							 }
						return true;
							 }

					function loadImage(id,name) {

						var token =  '[[${session.token}]]'; 
						//alert(token);
						
						
						$.ajax({
							url : '/dms-app/user/view-doc/'+id,
							type : 'GET',
							headers: {"Authorization": 'Bearer '+token},
							statusCode : {
								200 : function(data,status,request) {
									
									//alert(data);
									
									//alert("Con--"+request.getResponseHeader('Content-type'));
									
									var contentType=request.getResponseHeader('Content-type');
									
									//alert(contentType);
									
									if(contentType=='application/pdf'){
										
										loadPDF(data);
										$('#myModal9').modal('show');
										
 
									}
									else if(contentType=='application/image'){
										$("#imagePreview")
										.html(
												'<div class="class="columns is-flex is-centered"><div class="card"><div class="card-image"> <figure class="image"> <img data-toggle="modal" data-target="#myModal4" id="imageFile" name="'+name+'"  src="data:image/png;base64,' + data + '" /></figure></div></div></div>');
							 
										$('#myModal4').modal('show');
									}
									else if(contentType=='application/tiff'){
										
										try {
											showTiff(data);
										$('#myModal8').modal('show');
										}
										catch(e){
											var link = document.createElement("a");
										    link.setAttribute('download', name);
										    link.href = "data:"+contentType+";base64,"+data;
										    document.body.appendChild(link);
										    link.click();
										   link.remove();
										}
									}
									
									else{
										
										var link = document.createElement("a");
									    link.setAttribute('download', name);
									    link.href = "data:"+contentType+";base64,"+data;
									    document.body.appendChild(link);
									    link.click();
									   link.remove();
										
									}
								
								},
								error: function(xhr) { 
				                    swal({
										title : "Error Occured!",
										text : "Something went wrong. Please contact support team.",
										type : "error"
									});
				                }
							}
						});

					}
					
					function base64ToArrayBuffer(base64) {
					    var binary_string = window.atob(base64);
					    var len = binary_string.length;
					    var bytes = new Uint8Array(len);
					    for (var i = 0; i < len; i++) {
					        bytes[i] = binary_string.charCodeAt(i);
					    }
					    return bytes.buffer;
					}
					
					function base64ToArray(base64) {
					    var binary_string = window.atob(base64);
					    var len = binary_string.length;
					    var bytes = new Uint8Array(len);
					    for (var i = 0; i < len; i++) {
					        bytes[i] = binary_string.charCodeAt(i);
					    }
					    return bytes;
					}
					
					function showTiff(base64Tiff){
						
						var buffer = base64ToArrayBuffer(base64Tiff);
						var tiff = new Tiff({ buffer });
						
							var canvas = tiff.toCanvas();
							var width = tiff.width();
					      var height = tiff.height();	
					       
					      if (canvas) {
					                 // Set the width and height width: 560px; height: 300px; scale the picture proportionally
					        var scale = 1;
					        if (width > 1000 || height > 1000) {
					          if (width > height) {
					            scale =  800 / width;
					          }else {
					            scale = 800 / height;
					          }
					        }
					        canvas.setAttribute('style', 'width:' + (width * scale) +
					          'px; height: ' + (height * scale) + 'px'); 
					        $('#pdfView').empty().append(canvas);
					        
					      }  
					       
					}
					
					
					/* document.querySelector("#pdf-prev").addEventListener('click', function() {
					    if(_CURRENT_PAGE != 1)
					        showPage(--_CURRENT_PAGE);
					});

					// click on the "Next" page button
					document.querySelector("#pdf-next").addEventListener('click', function() {
					    if(_CURRENT_PAGE != _TOTAL_PAGES)
					        showPage(++_CURRENT_PAGE);
					}); */
					
					function loadPDF(data){
						var pdfData=atob(data);
						
						var loadingTask = pdfjsLib.getDocument({data: pdfData});
						loadingTask.promise.then(function(pdf) {
						  console.log('PDF loaded');
						  
						  // Fetch the first page
						  var pageNumber = 1;
						  pdf.getPage(pageNumber).then(function(page) {
						    console.log('Page loaded');
						    
						    var scale = 1;
						    //
						    var viewport = page.getViewport({scale: scale});
							//var viewport = page.getViewport(2.0);
																
						    // Prepare canvas using PDF page dimensions
						    var canvas = document.getElementById('pdf-canvas');
						    var context = canvas.getContext('2d');
						    canvas.height = viewport.height;
						    canvas.width = viewport.width;

						    // Render PDF page into canvas context
						    var renderContext = {
						      canvasContext: context,
						      viewport: viewport
						    };
						    var renderTask = page.render(renderContext);
						    renderTask.promise.then(function () {
						      console.log('Page rendered');
						    });
						  });
						}, function (reason) {
						  // PDF loading error
						  console.error(reason);
						});
					}
					
					function loopList(){
			    	alert('looping');
			    	var arr=['11eb3b7d8cd0b150bbf753b5e6d478f5', '11eb3b7d8cd0b150bbf753b5e6d478f5', '11eb3b7d8cd0b150bbf753b5e6d478f5', '11eb3b7d8cd0b150bbf753b5e6d478f5'];
			    	 var allpermissionList =  '[[${searchList}]]'; 
			    	 console.log(allpermissionList);
			    	 $.each(arr, function( index, value ) {
			 			alert(value );
			 		});

			    } 
					
					
					function check() {
						//alert('kk');
					    var inputs = document.getElementsByTagName("input");
					    var textareas = document.getElementsByTagName("textarea");
					    var filled = true;
					    var oneChecked = false;
					    
					    for (var i = 0; i < inputs.length; i++) {
					        if (inputs[i].type === "text" && !inputs[i].value) {
					            filled = false;
					        }
					       
					    }
					    
					    var count = 0;

					    $('select').each(function(){
					      
					    if($(this).val() != null){
					       count ++; 
					     }
					     
					  });
					    if(count == 4) {
					    	oneChecked = true;
					    }

					    if (!oneChecked) {
					        filled = false;
					    }

					      
					    if (filled) {
					        document.getElementById("uploadSubmitBtn").disabled = false;
					    } else {
					        document.getElementById("uploadSubmitBtn").disabled = true;
					    }
					}
					
					
					
    
				</script>
</body>

</html>
